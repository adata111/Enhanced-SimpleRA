LOAD EMPLOYEE
Q1_temp <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM Q1_temp

EMP_CROSS <- CROSS EMPLOYEE EMPLOYEE
SUPERVISOR <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM EMP_CROSS
Q2_TEMP <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM SUPERVISOR
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn, EMPLOYEE1_Bdate FROM Q2_TEMP
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2

LOAD WORKS_ON
EMP_WO_CROSS <- CROSS EMPLOYEE WORKS_ON
EMP_WORKS_ON <- SELECT Ssn == Essn FROM EMP_WO_CROSS
S0 <- SELECT Sex == 0 FROM EMP_WORKS_ON
S1 <- SELECT Sex == 1 FROM EMP_WORKS_ON
CROSS_S0_S1 <- CROSS S0 S1
Q3_TEMP <- SELECT S0_Pno == S1_Pno FROM CROSS_S0_S1
Q3 <- PROJECT S0_Pno FROM Q3_TEMP
RENAME S0_Pno TO Pno FROM Q3

PROJECTED_EMP_WORKS_ON <- PROJECT Ssn, Super_ssn, Pno FROM EMP_WORKS_ON
EMP_WORKS_ON_CROSS <- CROSS PROJECTED_EMP_WORKS_ON PROJECTED_EMP_WORKS_ON
Q4_TEMP1 <- SELECT PROJECTED_EMP_WORKS_ON1_Pno == PROJECTED_EMP_WORKS_ON2_Pno FROM EMP_WORKS_ON_CROSS
Q4_TEMP2 <- SELECT PROJECTED_EMP_WORKS_ON1_Super_ssn == PROJECTED_EMP_WORKS_ON2_Ssn FROM Q4_TEMP1
Q4 <- PROJECT PROJECTED_EMP_WORKS_ON1_Ssn, PROJECTED_EMP_WORKS_ON1_Super_ssn, PROJECTED_EMP_WORKS_ON1_Pno FROM Q4_TEMP2
RENAME PROJECTED_EMP_WORKS_ON1_Ssn TO Ssn FROM Q4
RENAME PROJECTED_EMP_WORKS_ON1_Super_ssn TO Super_ssn FROM Q4
RENAME PROJECTED_EMP_WORKS_ON1_Pno TO Pno FROM Q4

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
QUIT
